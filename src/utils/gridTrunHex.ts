import { Grid, Line, Extent, Use } from "@/utils/GridBasics";

export class TriGrid implements Grid {
  constructor(
    private baseLen: number,
    private gridName: string,
    private cell: Array<Line>
  ) {}

  cellLen(): number {
    return this.baseLen;
  }
  name(): string {
    return this.gridName;
  }
  base(): Array<Line> {
    return this.cell;
  }
  plot(ext: Extent): Array<Use> {
    const arr: Array<Use> = [];
    // these loops need to cover the extent
    // find the number of cells in each direction to cover the extent
    const wid = Math.ceil((2 * ext.right) / this.baseLen) + 1;
    const hgt = Math.ceil(ext.top / (this.baseLen * 0.866)) + 1;
    const lBeg = Math.ceil((2 * ext.left) / this.baseLen) - 1;
    const bBeg = Math.ceil(ext.bottom / (this.baseLen * 0.866)) - 1;
    //console.log(`Loop: ${lBeg} ${bBeg} ${wid} ${hgt}`);
    // this not quite right. there should be one cell centered on 0,0
    //    and things should work out from there...
    for (let i = bBeg; i < hgt; i++) {
      for (let j = lBeg; j < wid; j++) {
        let trans = "";
        const x = (j * this.baseLen) / 2;
        const y = i * this.baseLen * 0.866;
        if ((i + j) % 2 === 1 || (i + j) % 2 === -1) {
          trans = `rotate(180,${x},${y})`;
        }
        arr.push({ x: x, y: y, trans: trans, href: `#${this.gridName}` });
      }
    }
    return arr;
  }
}

export const GridTruncHex = new TriGrid(3.732, "trunchex", [
  { x1: 0.0, y1: 1.616, x2: 0, y2: 1.116 },
  { x1: 0.0, y1: 1.116, x2: 0.5, y2: 0.25 },
  { x1: 0.0, y1: 1.116, x2: -0.5, y2: 0.25 },
  { x1: -0.5, y1: 0.25, x2: 0.5, y2: 0.25 },
  { x1: -0.5, y1: 0.25, x2: -0.933, y2: 0.0 },
  { x1: 0.5, y1: 0.25, x2: 0.933, y2: 0.0 }
]);

export const GridTruncTriHex = new TriGrid(4.732, "tunctrihex", [
  { x1: -0.5, y1: 1.549, x2: 0.5, y2: 1.549 },
  { x1: 0.5, y1: 2.049, x2: 0.5, y2: 1.549 },
  { x1: -0.5, y1: 2.049, x2: -0.5, y2: 1.549 },
  { x1: -0.5, y1: 1.549, x2: -1, y2: 0.683 },
  { x1: 0.5, y1: 1.549, x2: 1, y2: 0.683 },
  { x1: -1, y1: 0.683, x2: -1.433, y2: 0.433 },
  { x1: 1, y1: 0.683, x2: 1.433, y2: 0.433 },
  { x1: -0.5, y1: -0.183, x2: -1, y2: 0.683 },
  { x1: 0.5, y1: -0.183, x2: 1, y2: 0.683 },
  { x1: -0.5, y1: -0.183, x2: 0.5, y2: -0.183 },
  { x1: -0.5, y1: -0.183, x2: -0.933, y2: -0.433 },
  { x1: 0.5, y1: -0.183, x2: 0.933, y2: -0.433 }
]);

export const GridRhombiTriHex = new TriGrid(2.723, "rhombitrihex", [
  { x1: -0.5, y1: 1.183, x2: -0.5, y2: 0.683 },
  { x1: 0.5, y1: 1.183, x2: 0.5, y2: 0.683 },
  { x1: -0.5, y1: 0.683, x2: 0.5, y2: 0.683 },
  { x1: 0.933, y1: 0.433, x2: 0.5, y2: 0.683 },
  { x1: -0.933, y1: 0.433, x2: -0.5, y2: 0.683 },
  { x1: -0.5, y1: 0.683, x2: 0, y2: -0.183 },
  { x1: 0.5, y1: 0.683, x2: 0, y2: -0.183 },
  { x1: 0, y1: -0.183, x2: 0.433, y2: -0.433 },
  { x1: 0, y1: -0.183, x2: -0.433, y2: -0.433 }
]);

export const GridHex = new TriGrid(1.723, "hex", [
  { x1: 0, y1: -0.25, x2: 0, y2: -0.75 },
  { x1: 0, y1: -0.25, x2: 0.433, y2: 0 },
  { x1: 0, y1: -0.25, x2: -0.433, y2: 0 }
]);

export const GridTri = new TriGrid(1.723, "tri", [
  { x1: 0.0, y1: 0.75, x2: 0.0, y2: -0.75 },
  { x1: -0.866, y1: -0.75, x2: 0.433, y2: 0 },
  { x1: 0.866, y1: -0.75, x2: -0.433, y2: 0 }
]);

export const GridTriHex = new TriGrid(2, "trihex", [
  { x1: -0.5, y1: 0, x2: 0.5, y2: 0.0 },
  { x1: -0.5, y1: 0, x2: 0, y2: 0.866 },
  { x1: 0.5, y1: 0, x2: 0, y2: 0.866 }
]);

// rhombihexext
export const GridRhombiHexExt = new TriGrid(3.723, "rhombihexext", [
  { x1: 0, y1: 1.616, x2: 0, y2: 1.115 },
  { x1: 1, y1: 1.616, x2: 1, y2: 1.115 },
  { x1: -1, y1: 1.616, x2: -1, y2: 1.115 },
  { x1: -1, y1: 1.115, x2: 1, y2: 1.115 },
  { x1: 0, y1: 1.115, x2: 0.5, y2: 0.25 },
  { x1: 0, y1: 1.115, x2: -0.5, y2: 0.25 },
  { x1: 0.5, y1: 0.25, x2: -0.5, y2: 0.25 },
  { x1: 1.0, y1: 1.115, x2: 0, y2: -0.617 },
  { x1: -1, y1: 1.115, x2: 0, y2: -0.617 },
  { x1: -1.0, y1: 1.115, x2: -1.433, y2: 0.865 },
  { x1: 1.0, y1: 1.115, x2: 1.433, y2: 0.865 },
  { x1: -0.5, y1: 0.25, x2: -0.933, y2: 0.0 },
  { x1: 0.5, y1: 0.25, x2: 0.933, y2: 0.0 },
  { x1: 0, y1: -0.617, x2: -0.433, y2: -0.867 },
  { x1: 0, y1: -0.617, x2: 0.433, y2: -0.867 }
]);

export const GridDoDecHex = new TriGrid(5.464, "dodechex", [
  { x1: -0.8661, y1: -2.3661, x2: -0.8661, y2: -1.8661 },
  { x1: 0.8661, y1: -2.3661, x2: 0.8661, y2: -1.8661 },
  { x1: 0.8661, y1: -1.8661, x2: 0, y2: -1.3661 },
  { x1: -0.8661, y1: -1.8661, x2: 0, y2: -1.3661 },
  { x1: -0.8661, y1: -1.8661, x2: -1.3661, y2: -1.0 },
  { x1: 0.8661, y1: -1.8661, x2: 1.3661, y2: -1.0 },
  { x1: 0, y1: -1.3661, x2: 0.5, y2: -0.5 },
  { x1: 0, y1: -1.3661, x2: -0.5, y2: -0.5 },
  { x1: 0.5, y1: -0.5, x2: -0.5, y2: -0.5 },
  { x1: 1.3661, y1: -1.0, x2: 0.5, y2: -0.5 },
  { x1: -1.3661, y1: -1.0, x2: -0.5, y2: -0.5 },
  { x1: -1.3661, y1: -1.0, x2: -1.7991, y2: -0.75 },
  { x1: 1.3661, y1: -1.0, x2: 1.7991, y2: -0.75 },
  { x1: 0.5, y1: 0.5, x2: -0.5, y2: 0.5 },
  { x1: 0.5, y1: -0.5, x2: 0.5, y2: 0.5 },
  { x1: -0.5, y1: -0.5, x2: -0.5, y2: 0.5 },
  { x1: 0.5, y1: 0.5, x2: 0.933, y2: 0.75 },
  { x1: -0.5, y1: 0.5, x2: -0.933, y2: 0.75 }
]);

export const GridHexSq = new TriGrid(3.7322, "hexsq", [
  { x1: 0.0, y1: -1.6161, x2: 0.0, y2: -1.1161 },
  { x1: 0.0, y1: -1.1161, x2: -0.8661, y2: -1.6161 },
  { x1: 0.0, y1: -1.1161, x2: 0.8661, y2: -1.6161 },
  { x1: -0.8661, y1: -1.6161, x2: -1.3661, y2: -0.75 },
  { x1: 0.8661, y1: -1.6161, x2: 1.3661, y2: -0.75 },
  { x1: 0.0, y1: -1.1161, x2: 0.5, y2: -0.25 },
  { x1: 0.0, y1: -1.1161, x2: -0.5, y2: -0.25 },
  { x1: -0.5, y1: -0.25, x2: 0.5, y2: -0.25 },
  { x1: -1.3661, y1: -0.75, x2: -0.5, y2: -0.25 },
  { x1: 1.3661, y1: -0.75, x2: 0.5, y2: -0.25 },
  { x1: -0.5, y1: -0.25, x2: -0.5, y2: 0.75 },
  { x1: 0.5, y1: -0.25, x2: 0.5, y2: 0.75 },
  { x1: -0.5, y1: 0.75, x2: 0.5, y2: 0.75 },
  { x1: -0.5, y1: -0.25, x2: -0.933, y2: 0 },
  { x1: 0.5, y1: -0.25, x2: 0.933, y2: 0 }
]);

export const GridHexHexSq = new TriGrid(4.7322, "hexhexsq", [
  { x1: -0.5, y1: -2.0492, x2: -0.5, y2: -1.5492 },
  { x1: -1.5, y1: -2.0492, x2: -1.5, y2: -1.5492 },
  { x1: 0.5, y1: -2.0492, x2: 0.5, y2: -1.5492 },
  { x1: 1.5, y1: -2.0492, x2: 1.5, y2: -1.5492 },
  { x1: -1.5, y1: -1.5492, x2: 1.5, y2: -1.5492 },
  { x1: -1.5, y1: -1.5492, x2: 0, y2: 1.0489 },
  { x1: 1.5, y1: -1.5492, x2: 0, y2: 1.0489 },
  { x1: 0.5, y1: -1.5492, x2: 1, y2: -0.6831 },
  { x1: -0.5, y1: -1.5492, x2: -1, y2: -0.6831 },
  { x1: -0.5, y1: 0.183, x2: 0.5, y2: 0.183 },
  { x1: -1.5, y1: -1.5492, x2: -1.933, y2: -1.2992 },
  { x1: -1, y1: -0.6831, x2: -1.433, y2: -0.4331 },
  { x1: -0.5, y1: 0.183, x2: -0.933, y2: 0.433 },
  { x1: 0, y1: 1.0489, x2: -0.433, y2: 1.2989 },
  { x1: 1.5, y1: -1.5492, x2: 1.933, y2: -1.2992 },
  { x1: 1, y1: -0.6831, x2: 1.433, y2: -0.4331 },
  { x1: 0.5, y1: 0.183, x2: 0.933, y2: 0.433 },
  { x1: 0, y1: 1.0489, x2: 0.433, y2: 1.2989 }
]);

/*  { x1: -0.8661, y1: 0, x2: -0.8661, y2: 0.5 },
  { x1: 0.8661, y1: 0, x2: 0.8661, y2: 0.5 },
  { x1: 0.8661, y1: 0.5, x2: 0, y2: 1.0 },
  { x1: -0.8661, y1: 0.5, x2: 0, y2: 1.0 },
  { x1: -0.8661, y1: 0.5, x2: -1.3661, y2: 1.3661 },
  { x1: 0.8661, y1: 0.5, x2: 1.3661, y2: 1.3661 },
  { x1: 0, y1: 1.0, x2: 0.5, y2: 1.8661 },
  { x1: 0, y1: 1.0, x2: -0.5, y2: 1.8661 },
  { x1: 0.5, y1: 1.8661, x2: -0.5, y2: 1.8661 },
  { x1: 1.3661, y1: 1.3661, x2: 0.5, y2: 1.8661 },
  { x1: -1.3661, y1: 1.3661, x2: -0.5, y2: 1.8661 },
  { x1: -1.3661, y1: 1.3661, x2: -1.7991, y2: 1.6161 },
  { x1: 1.3661, y1: 1.3661, x2: 1.7991, y2: 1.6161 },
  { x1: 0.5, y1: 2.8661, x2: -0.5, y2: 2.8661 },
  { x1: 0.5, y1: 1.8661, x2: 0.5, y2: 2.8661 },
  { x1: -0.5, y1: 1.8661, x2: -0.5, y2: 2.8661 },
  { x1: 0.5, y1: 2.8661, x2: 0.933, y2: 3.1161 },
  { x1: -0.5, y1: 2.8661, x2: -0.933, y2: 3.1161 }
*/

// rhombitrihexbase, rhombitrihex w/ sub divided hex
/*  cellDHex3: Array<Line> = [
    { x1: -0.5, y1: 1.183, x2: -0.5, y2: 0.683 },
    { x1: 0.5, y1: 1.183, x2: 0.5, y2: 0.683 },
    { x1: -0.5, y1: 0.683, x2: 0.5, y2: 0.683 },
    { x1: 0.5, y1: 0.683, x2: 1.366, y2: 1.183 },
    { x1: -0.5, y1: 0.683, x2: -1.366, y2: 1.183 },
    { x1: 0, y1: -0.183, x2: 0, y2: -1.183 },
    { x1: 0.933, y1: 0.433, x2: 0.5, y2: 0.683 },
    { x1: -0.933, y1: 0.433, x2: -0.5, y2: 0.683 },
    { x1: -0.5, y1: 0.683, x2: 0, y2: -0.183 },
    { x1: 0.5, y1: 0.683, x2: 0, y2: -0.183 },
    { x1: 0, y1: -0.183, x2: 0.433, y2: -0.433 },
    { x1: 0, y1: -0.183, x2: -0.433, y2: -0.433 }
  ];*/

// rhombihexextbase, rhombihexext w/ sub divided hex
/*  cellTHex4: Array<Line> = [
    { x1: 0, y1: 0.808, x2: 0.0, y2: 0.308 },
    { x1: 1, y1: 0.808, x2: 1, y2: 0.308 },
    { x1: -1, y1: 0.808, x2: -1, y2: 0.308 },
    { x1: -1, y1: 0.308, x2: 1, y2: 0.308 },
    { x1: 0, y1: 0.308, x2: 0.5, y2: -0.558 },
    { x1: 0, y1: 0.308, x2: -0.5, y2: -0.558 },
    { x1: 0.5, y1: -0.558, x2: -0.5, y2: -0.558 },
    { x1: 1.0, y1: 0.308, x2: 0, y2: -1.424 },
    { x1: -1, y1: 0.308, x2: 0, y2: -1.424 },
    { x1: -1, y1: 0.308, x2: -1.433, y2: 0.058 },
    { x1: 1, y1: 0.308, x2: 1.433, y2: 0.058 },
    { x1: -0.5, y1: -0.558, x2: -0.933, y2: -0.808 },
    { x1: 0.5, y1: -0.558, x2: 0.933, y2: -0.808 },
    { x1: 0, y1: -1.424, x2: -0.433, y2: -1.674 },
    { x1: 0, y1: -1.424, x2: 0.433, y2: -1.674 },
    { x1: 1.8661, y1: 0.808, x2: 1.0, y2: 0.308 },
    { x1: -1.8661, y1: 0.808, x2: -1.0, y2: 0.308 },
    { x1: 0, y1: -1.424, x2: 0, y2: -2.424 }
  ];*/
